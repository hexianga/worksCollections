class Maintenance{constructor(){this.useTime=6;this.WriteOff=[];this.DistanceRelated=[];this.TimeRelated=[];this.WriteOffBrand=[];this.DistanceRelatedBrand=[];this.TimeRelatedBrand=[];this.WritedOff=[];this.bigMonth=[1,3,5,7,8,10,12];this.smallMonth=[4,6,9,11];}contains(value,array){let length=array.length;for(let i=0;i<length;i++){if(array[i]===value){return true;}}return false;}arrSort(brand,carNumber){let arr=brand,arr1=carNumber;let length=arr.length;for(let i=0;i<length;i++){for(let j=i+1;j<length;j++){if(arr[i]==arr[j]){arr.splice(j,1);arr1[i]=arr1[i]+", "+arr1[j];arr1.splice(j,1);length--;j--;}}}length=arr.length;for(let i=0;i<length-1;i++){for(let j=i+1;j<length;j++){if(arr[i]>arr[j]){let temp=arr[i];arr[i]=arr[j];arr[j]=temp;temp=arr1[i];arr1[i]=arr1[j];arr1[j]=temp;}}}return arr;}getReminder(nows,string){let car=string.split('|');let gettime=car[1].split('/');let now=nows.split('/');if(car[4].charAt(0)=="T"){this.useTime=3;}else{this.useTime=6;}let year=parseInt(now[0])-parseInt(gettime[0]);if((this.useTime==6&&year>6)||(this.useTime==3&&year>3)){this.WritedOff.push(car[0]);}if(((this.useTime==6&&year==6)||(this.useTime==3&&year==3))&&(parseInt(now[1])>parseInt(gettime[1]))){this.WritedOff.push(car[0]);}if(!this.contains(car[0],this.WritedOff)){if(year==2||year==5){let count=0;for(let i=gettime[0];i<=now[0];i++){if((i%100!=0&&i%4==0)||(i%100==0&&i%400==0)){count++;}}if(count==1){if(gettime[1]==="01"||(gettime[1]==="02"&&(gettime[2]==="01"))){if(gettime[1]==="01"&&gettime[2]==="01"){if(now[1]==="11"||(now[1]==="12"&&now[2].slice(0,2)!=="31")){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}else if(now[1]==="12"&&now[2].slice(0,2)==="31"){this.WritedOff.push(car[0]);}}else{if(now[1]==="12"){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}}}}else if(count==2){if(gettime[1]==="01"&&gettime[2]==="01"){if(now[1]==="11"||((now[1]==="12"&&now[2].slice(0,2)!=="31")&&(now[1]==="12"&&now[2].slice(0,2)!=="30"))){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if((now[1]==="12"&&now[2].slice(0,2)==="31")||(now[1]==="12"&&now[2].slice(0,2)==="30")){this.WritedOff.push(car[0]);}}if(gettime[1]==="01"&&gettime[2]==="02"){if(now[1]==="11"||(now[1]==="12"&&now[2].slice(0,2)!=="31")){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(now[1]==="12"&&now[2].slice(0,2)==="31"){this.WritedOff.push(car[0]);}}if((gettime[1]==="01"&&gettime[2]!=="02"&&gettime[2]!=="01")||(gettime[1]==="02"&&(gettime[2]==="01"))||(gettime[1]==="02"&&(gettime[2]==="02"))){if(now[1]==="12"){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}}}else if(count==0){if(gettime[1]==="01"&&now[1]==="12"){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}}}else if(year==3||year==6){let count=0;for(let i=gettime[0];i<=now[0];i++){if((i%100!=0&&i%4==0)||(i%100==0&&i%400==0)){count++;}}if((parseInt(gettime[1])-parseInt(now[1]))==1){if(count==1){if(gettime[2]>=2&&gettime[2]<=31){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(gettime[2]==1){if(this.contains(parseInt(now[1]),this.bigMonth)&&now[2].slice(0,2)!=31){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(this.contains(parseInt(now[1]),this.bigMonth)&&now[2].slice(0,2)==31){this.WritedOff.push(car[0]);}if(this.contains(parseInt(now[1]),this.smallMonth)&&now[2].slice(0,2)!=30){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(this.contains(parseInt(now[1]),this.smallMonth)&&now[2].slice(0,2)==30){this.WritedOff.push(car[0]);}if(parseInt(now[1])==2&&now[2].slice(0,2)!=28){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(parseInt(now[1])==2&&now[2].slice(0,2)==28){this.WritedOff.push(car[0]);}}}else if(count==2){if(gettime[2]>=2&&gettime[2]<=31){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if((parseInt(now[0])-1)%4==0){if(gettime[2]==1){if(this.contains(parseInt(now[1]),this.bigMonth)&&now[2].slice(0,2)!=31&&now[2].slice(0,2)!=30){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(this.contains(parseInt(now[1]),this.smallMonth)&&now[2].slice(0,2)!=30&&now[2].slice(0,2)!=29){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(parseInt(now[1])==2&&now[2].slice(0,2)!=28&&now[2].slice(0,2)!=27){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(this.contains(parseInt(now[1]),this.bigMonth)&&(now[2].slice(0,2)==31||now[2].slice(0,2)==30)){this.WritedOff.push(car[0]);}if(this.contains(parseInt(now[1]),this.smallMonth)&&(now[2].slice(0,2)==30||now[2].slice(0,2)==29)){this.WritedOff.push(car[0]);}if(parseInt(now[1])==2&&now[2].slice(0,2)==28&&now[2].slice(0,2)==27){this.WritedOff.push(car[0]);}}if(gettime[2]==2){if(this.contains(parseInt(now[1]),this.bigMonth)&&now[2].slice(0,2)!=31){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(this.contains(parseInt(now[1]),this.smallMonth)&&now[2].slice(0,2)!=30){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(parseInt(now[1])==2&&now[2].slice(0,2)!=28){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(this.contains(parseInt(now[1]),this.bigMonth)&&now[2].slice(0,2)==31){this.WritedOff.push(car[0]);}if(this.contains(parseInt(now[1]),this.smallMonth)&&now[2].slice(0,2)==30){this.WritedOff.push(car[0]);}if(parseInt(now[1])==2&&now[2].slice(0,2)==28){this.WritedOff.push(car[0]);}}}else if(parseInt(now[0])%4==0){if(now[1]==1||(now[1]==2&&now[2].slice(0,2)!=29)){if(gettime[2]==1){if(this.contains(parseInt(now[1]),this.bigMonth)&&now[2].slice(0,2)!=31){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(this.contains(parseInt(now[1]),this.smallMonth)&&now[2].slice(0,2)!=30){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(parseInt(now[1])==2&&now[2].slice(0,2)!=29){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(this.contains(parseInt(now[1]),this.bigMonth)&&now[2].slice(0,2)==31){this.WritedOff.push(car[0]);}if(this.contains(parseInt(now[1]),this.smallMonth)&&now[2].slice(0,2)==30){this.WritedOff.push(car[0]);}if(parseInt(now[1])==2&&now[2].slice(0,2)==29){this.WritedOff.push(car[0]);}}}else{if(gettime[2]==1){if(this.contains(parseInt(now[1]),this.bigMonth)&&now[2].slice(0,2)!=31&&now[2].slice(0,2)!=30){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(this.contains(parseInt(now[1]),this.smallMonth)&&now[2].slice(0,2)!=30&&now[2].slice(0,2)!=29){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(parseInt(now[1])==2&&now[2].slice(0,2)!=29&&now[2].slice(0,2)!=28){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(this.contains(parseInt(now[1]),this.bigMonth)&&(now[2].slice(0,2)==31||now[2].slice(0,2)==30)){this.WritedOff.push(car[0]);}if(this.contains(parseInt(now[1]),this.smallMonth)&&(now[2].slice(0,2)==30||now[2].slice(0,2)==29)){this.WritedOff.push(car[0]);}if(parseInt(now[1])==2&&(now[2].slice(0,2)==29||now[2].slice(0,2)==28)){this.WritedOff.push(car[0]);}}}}else if((parseInt(now[0])+2)%4==0){if(gettime[1]==2){if(gettime[2]==1){if(now[2].slice(0,2)!=31&&now[2].slice(0,2)!=30){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(now[2].slice(0,2)==31||now[2].slice(0,2)==30){this.WritedOff.push(car[0]);}}else if(gettime[2]==2){if(now[2].slice(0,2)!=31){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(now[2].slice(0,2)==31){this.WritedOff.push(car[0]);}}}else{if(gettime[2]==1){if(this.contains(parseInt(now[1]),this.bigMonth)&&now[2].slice(0,2)!=31){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(this.contains(parseInt(now[1]),this.smallMonth)&&now[2].slice(0,2)!=30){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(parseInt(now[1])==2&&now[2].slice(0,2)!=28){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(this.contains(parseInt(now[1]),this.bigMonth)&&now[2].slice(0,2)==31){this.WritedOff.push(car[0]);}if(this.contains(parseInt(now[1]),this.smallMonth)&&now[2].slice(0,2)==30){this.WritedOff.push(car[0]);}if(parseInt(now[1])==2&&now[2].slice(0,2)==28){this.WritedOff.push(car[0]);}}}}}}if(now[1]==gettime[1]){if(count==1){if(parseInt(now[2].slice(0,2))<parseInt(gettime[2])-1){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}else{this.WritedOff.push(car[0]);}}else if(count==2){if((parseInt(now[0])-1)%4==0){if(parseInt(now[2].slice(0,2))<parseInt(gettime[2])-2){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}else{this.WritedOff.push(car[0]);}}else if(parseInt(now[0])%4==0){if(now[1]==1||(now[1]==2&&now[2].slice(0,2)!=29)){if(parseInt(now[2].slice(0,2))<parseInt(gettime[2])-1){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}else{this.WritedOff.push(car[0]);}}else{if(parseInt(now[2].slice(0,2))<parseInt(gettime[2])-2){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}else{this.WritedOff.push(car[0]);}}}else if((parseInt(now[0])+2)%4==0){if(gettime[1]==1||(gettime[1]==2&&gettime[2]!=29)){if(parseInt(now[2].slice(0,2))<parseInt(gettime[2])-2){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}else{this.WritedOff.push(car[0]);}}else{if(parseInt(now[2].slice(0,2))<parseInt(gettime[2])-1){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}else{this.WritedOff.push(car[0]);}}}}}if(parseInt(now[1])+2==gettime[1]){if(count==1&&gettime[2]==='01'){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}else if(count==2){if((parseInt(now[0])-1)%4==0){if(gettime[2]==='01'||gettime[2]==='02'){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}}else if(parseInt(now[0])%4==0){if(now[1]==1||(now[1]==2&&now[2].slice(0,2)!=29)){if(gettime[2]==='01'){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}}else{if(gettime[2]==='01'||gettime[2]==='02'){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}}}else if((parseInt(now[0])+2)%4==0){if(gettime[2]==='01'){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}}}}}}if((!this.contains(car[0],this.WriteOff))&&(!this.contains(car[0],this.WritedOff))){let distance=parseInt(car[3])%10000;if((distance<=10000&&distance>=9500)||distance==0){this.DistanceRelated.push(car[0]);this.DistanceRelatedBrand.push(car[2]);}}if((!this.contains(car[0],this.WriteOff))&&(!this.contains(car[0],this.DistanceRelated))&&(!this.contains(car[0],this.WritedOff))){if(this.useTime==6){if(parseInt(now[0])-parseInt(gettime[0])<3||(parseInt(now[0])-parseInt(gettime[0])==3&&parseInt(now[1])<=parseInt(gettime[1]))){if(parseInt(now[1])==parseInt(gettime[1])-1){this.TimeRelated.push(car[0]);this.TimeRelatedBrand.push(car[2]);}if(parseInt(now[1])==parseInt(gettime[1])&&parseInt(now[2].slice(0,2))<parseInt(gettime[2])){this.TimeRelated.push(car[0]);this.TimeRelatedBrand.push(car[2]);}if(gettime[1]==="01"&&now[1]==="12"){this.TimeRelated.push(car[0]);this.TimeRelatedBrand.push(car[2]);}}if(parseInt(now[0])-parseInt(gettime[0])>3||(parseInt(now[0])-parseInt(gettime[0])==3&&parseInt(now[1])>parseInt(gettime[1]))){let maintainMonth1=parseInt(gettime[1]),maintainMonth2=parseInt(gettime[1])+6>12?parseInt(gettime[1])-6:parseInt(gettime[1])+6;if(parseInt(now[1])==maintainMonth1-1||parseInt(now[1])==maintainMonth2-1){this.TimeRelated.push(car[0]);this.TimeRelatedBrand.push(car[2]);}if((parseInt(now[1])==maintainMonth1&&parseInt(now[2].slice(0,2))<parseInt(gettime[2]))||(parseInt(now[1])==maintainMonth2&&parseInt(now[2].slice(0,2))<parseInt(gettime[2]))){this.TimeRelated.push(car[0]);this.TimeRelatedBrand.push(car[2]);}if((gettime[1]==="01"&&now[1]==="12")||(gettime[1]==="07"&&now[1]==="12")){this.TimeRelated.push(car[0]);this.TimeRelatedBrand.push(car[2]);}}}else{let maintainMonth1=parseInt(gettime[1]),maintainMonth2=parseInt(gettime[1])+3>12?parseInt(gettime[1])-9:parseInt(gettime[1])+3,maintainMonth3=parseInt(gettime[1])+6>12?parseInt(gettime[1])-6:parseInt(gettime[1])+6,maintainMonth4=parseInt(gettime[1])+9>12?parseInt(gettime[1])-3:parseInt(gettime[1])+9;let Months=[maintainMonth1,maintainMonth2,maintainMonth3,maintainMonth4];let remindMonths=[maintainMonth1-1,maintainMonth2-1,maintainMonth3-1,maintainMonth4-1];if(this.contains(1,Months)&&now[1]==="12"){this.TimeRelated.push(car[0]);this.TimeRelatedBrand.push(car[2]);}if(this.contains(parseInt(now[1]),remindMonths)){this.TimeRelated.push(car[0]);this.TimeRelatedBrand.push(car[2]);}if(this.contains(parseInt(now[1]),Months)&&parseInt(now[2].slice(0,2))<parseInt(gettime[2])){this.TimeRelated.push(car[0]);this.TimeRelatedBrand.push(car[2]);}}}}}let btn=document.getElementById("btn");let btn2=document.getElementById("btn2");let input=document.getElementById('input');let uploadFile=document.getElementById("uploadFile");let show=false;let InputInfo=[];let cars=[];let now="";btn.onclick=function(){if(show){input.style.display='none';btn.innerHTML="显示输入信息";}else{if(document.getElementById("uploadFile").files[0]==null){alert("请上传文件！");return;}input.style.display='block';btn.innerHTML="隐藏输入信息";}show=!show;}uploadFile.onchange=function(){let localFile=document.getElementById("uploadFile").files[0];let reader=new FileReader();let content;reader.readAsText(localFile,"UTF-8");reader.onload=function(event){content=event.target.result;document.getElementById("fileContent").value=content;InputInfo=content.split('\n');}reader.onerror=function(event){alert('error')}}btn2.onclick=function(){if(InputInfo.length!=0){console.log(InputInfo);now=InputInfo[0].split(" ")[1];cars=InputInfo.slice(1);let maintenance=new Maintenance();for(let i=0;i<cars.length;i++){maintenance.getReminder(now,cars[i]);maintenance.TimeRelatedBrand=maintenance.arrSort(maintenance.TimeRelatedBrand,maintenance.TimeRelated)maintenance.DistanceRelatedBrand=maintenance.arrSort(maintenance.DistanceRelatedBrand,maintenance.DistanceRelated)maintenance.WriteOffBrand=maintenance.arrSort(maintenance.WriteOffBrand,maintenance.WriteOff)}let string1="";let string2="";let string3="";let length=maintenance.TimeRelatedBrand.length;for(let i=0;i<length;i++){string1+=maintenance.TimeRelatedBrand[i]+": "+maintenance.TimeRelated[i].split(", ").length+" ("+maintenance.TimeRelated[i]+")\n";}length=maintenance.DistanceRelatedBrand.length;for(let i=0;i<length;i++){string2+=maintenance.DistanceRelatedBrand[i]+": "+maintenance.DistanceRelated[i].split(", ").length+" ("+maintenance.DistanceRelated[i]+")\n";}length=maintenance.WriteOffBrand.length;for(let i=0;i<length;i++){string3+=maintenance.WriteOffBrand[i]+": "+maintenance.WriteOff[i].split(", ").length+" ("+maintenance.WriteOff[i]+")\n";}let text="Reminder"+"\n"+"=================="+"\n\n"+"* Time-related maintenance coming soon..."+"\n"+string1+"\n"+"* Distance-related maintenance coming soon..."+"\n"+string2+"\n"+"* Write-off coming soon..."+"\n"+string3;document.getElementById("output").value=text;}else{alert("请上传要处理的数据！");}}