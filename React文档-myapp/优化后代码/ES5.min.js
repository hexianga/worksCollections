'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value" in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}var Maintenance=function(){function Maintenance(){_classCallCheck(this,Maintenance);this.useTime=6;this.WriteOff=[];this.DistanceRelated=[];this.TimeRelated=[];this.WriteOffBrand=[];this.DistanceRelatedBrand=[];this.TimeRelatedBrand=[];this.WritedOff=[];this.bigMonth=[1,3,5,7,8,10,12];this.smallMonth=[4,6,9,11];}_createClass(Maintenance,[{key:'contains',value:function contains(value,array){var length=array.length;for(var i=0;i<length;i++){if(array[i]===value){return true;}}return false;}},{key:'arrSort',value:function arrSort(brand,carNumber){var arr=brand,arr1=carNumber;var length=arr.length;for(var i=0;i<length;i++){for(var j=i+1;j<length;j++){if(arr[i]==arr[j]){arr.splice(j,1);arr1[i]=arr1[i]+", "+arr1[j];arr1.splice(j,1);length--;j--;}}}length=arr.length;for(var _i=0;_i<length-1;_i++){for(var _j=_i+1;_j<length;_j++){if(arr[_i]>arr[_j]){var temp=arr[_i];arr[_i]=arr[_j];arr[_j]=temp;temp=arr1[_i];arr1[_i]=arr1[_j];arr1[_j]=temp;}}}return arr;}},{key:'getReminder',value:function getReminder(nows,string){var car=string.split('|');var gettime=car[1].split('/');var now=nows.split('/');if(car[4].charAt(0)=="T"){this.useTime=3;}else{this.useTime=6;}var year=parseInt(now[0])-parseInt(gettime[0]);if(this.useTime==6&&year>6||this.useTime==3&&year>3){this.WritedOff.push(car[0]);}if((this.useTime==6&&year==6||this.useTime==3&&year==3)&&parseInt(now[1])>parseInt(gettime[1])){this.WritedOff.push(car[0]);}if(!this.contains(car[0],this.WritedOff)){if(year==2||year==5){var count=0;for(var i=gettime[0];i<=now[0];i++){if(i%100!=0&&i%4==0||i%100==0&&i%400==0){count++;}}if(count==1){if(gettime[1]==="01"||gettime[1]==="02"&&gettime[2]==="01"){if(gettime[1]==="01"&&gettime[2]==="01"){if(now[1]==="11"||now[1]==="12"&&now[2].slice(0,2)!=="31"){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}else if(now[1]==="12"&&now[2].slice(0,2)==="31"){this.WritedOff.push(car[0]);}}else{if(now[1]==="12"){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}}}}else if(count==2){if(gettime[1]==="01"&&gettime[2]==="01"){if(now[1]==="11"||now[1]==="12"&&now[2].slice(0,2)!=="31"&&now[1]==="12"&&now[2].slice(0,2)!=="30"){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(now[1]==="12"&&now[2].slice(0,2)==="31"||now[1]==="12"&&now[2].slice(0,2)==="30"){this.WritedOff.push(car[0]);}}if(gettime[1]==="01"&&gettime[2]==="02"){if(now[1]==="11"||now[1]==="12"&&now[2].slice(0,2)!=="31"){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(now[1]==="12"&&now[2].slice(0,2)==="31"){this.WritedOff.push(car[0]);}}if(gettime[1]==="01"&&gettime[2]!=="02"&&gettime[2]!=="01"||gettime[1]==="02"&&gettime[2]==="01"||gettime[1]==="02"&&gettime[2]==="02"){if(now[1]==="12"){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}}}else if(count==0){if(gettime[1]==="01"&&now[1]==="12"){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}}}else if(year==3||year==6){var _count=0;for(var _i2=gettime[0];_i2<=now[0];_i2++){if(_i2%100!=0&&_i2%4==0||_i2%100==0&&_i2%400==0){_count++;}}if(parseInt(gettime[1])-parseInt(now[1])==1){if(_count==1){if(gettime[2]>=2&&gettime[2]<=31){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(gettime[2]==1){if(this.contains(parseInt(now[1]),this.bigMonth)&&now[2].slice(0,2)!=31){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(this.contains(parseInt(now[1]),this.bigMonth)&&now[2].slice(0,2)==31){this.WritedOff.push(car[0]);}if(this.contains(parseInt(now[1]),this.smallMonth)&&now[2].slice(0,2)!=30){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(this.contains(parseInt(now[1]),this.smallMonth)&&now[2].slice(0,2)==30){this.WritedOff.push(car[0]);}if(parseInt(now[1])==2&&now[2].slice(0,2)!=28){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(parseInt(now[1])==2&&now[2].slice(0,2)==28){this.WritedOff.push(car[0]);}}}else if(_count==2){if(gettime[2]>=2&&gettime[2]<=31){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if((parseInt(now[0])-1)%4==0){if(gettime[2]==1){if(this.contains(parseInt(now[1]),this.bigMonth)&&now[2].slice(0,2)!=31&&now[2].slice(0,2)!=30){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(this.contains(parseInt(now[1]),this.smallMonth)&&now[2].slice(0,2)!=30&&now[2].slice(0,2)!=29){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(parseInt(now[1])==2&&now[2].slice(0,2)!=28&&now[2].slice(0,2)!=27){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(this.contains(parseInt(now[1]),this.bigMonth)&&(now[2].slice(0,2)==31||now[2].slice(0,2)==30)){this.WritedOff.push(car[0]);}if(this.contains(parseInt(now[1]),this.smallMonth)&&(now[2].slice(0,2)==30||now[2].slice(0,2)==29)){this.WritedOff.push(car[0]);}if(parseInt(now[1])==2&&now[2].slice(0,2)==28&&now[2].slice(0,2)==27){this.WritedOff.push(car[0]);}}if(gettime[2]==2){if(this.contains(parseInt(now[1]),this.bigMonth)&&now[2].slice(0,2)!=31){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(this.contains(parseInt(now[1]),this.smallMonth)&&now[2].slice(0,2)!=30){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(parseInt(now[1])==2&&now[2].slice(0,2)!=28){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(this.contains(parseInt(now[1]),this.bigMonth)&&now[2].slice(0,2)==31){this.WritedOff.push(car[0]);}if(this.contains(parseInt(now[1]),this.smallMonth)&&now[2].slice(0,2)==30){this.WritedOff.push(car[0]);}if(parseInt(now[1])==2&&now[2].slice(0,2)==28){this.WritedOff.push(car[0]);}}}else if(parseInt(now[0])%4==0){if(now[1]==1||now[1]==2&&now[2].slice(0,2)!=29){if(gettime[2]==1){if(this.contains(parseInt(now[1]),this.bigMonth)&&now[2].slice(0,2)!=31){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(this.contains(parseInt(now[1]),this.smallMonth)&&now[2].slice(0,2)!=30){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(parseInt(now[1])==2&&now[2].slice(0,2)!=29){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(this.contains(parseInt(now[1]),this.bigMonth)&&now[2].slice(0,2)==31){this.WritedOff.push(car[0]);}if(this.contains(parseInt(now[1]),this.smallMonth)&&now[2].slice(0,2)==30){this.WritedOff.push(car[0]);}if(parseInt(now[1])==2&&now[2].slice(0,2)==29){this.WritedOff.push(car[0]);}}}else{if(gettime[2]==1){if(this.contains(parseInt(now[1]),this.bigMonth)&&now[2].slice(0,2)!=31&&now[2].slice(0,2)!=30){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(this.contains(parseInt(now[1]),this.smallMonth)&&now[2].slice(0,2)!=30&&now[2].slice(0,2)!=29){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(parseInt(now[1])==2&&now[2].slice(0,2)!=29&&now[2].slice(0,2)!=28){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(this.contains(parseInt(now[1]),this.bigMonth)&&(now[2].slice(0,2)==31||now[2].slice(0,2)==30)){this.WritedOff.push(car[0]);}if(this.contains(parseInt(now[1]),this.smallMonth)&&(now[2].slice(0,2)==30||now[2].slice(0,2)==29)){this.WritedOff.push(car[0]);}if(parseInt(now[1])==2&&(now[2].slice(0,2)==29||now[2].slice(0,2)==28)){this.WritedOff.push(car[0]);}}}}else if((parseInt(now[0])+2)%4==0){if(gettime[1]==2){if(gettime[2]==1){if(now[2].slice(0,2)!=31&&now[2].slice(0,2)!=30){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(now[2].slice(0,2)==31||now[2].slice(0,2)==30){this.WritedOff.push(car[0]);}}else if(gettime[2]==2){if(now[2].slice(0,2)!=31){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(now[2].slice(0,2)==31){this.WritedOff.push(car[0]);}}}else{if(gettime[2]==1){if(this.contains(parseInt(now[1]),this.bigMonth)&&now[2].slice(0,2)!=31){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(this.contains(parseInt(now[1]),this.smallMonth)&&now[2].slice(0,2)!=30){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(parseInt(now[1])==2&&now[2].slice(0,2)!=28){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}if(this.contains(parseInt(now[1]),this.bigMonth)&&now[2].slice(0,2)==31){this.WritedOff.push(car[0]);}if(this.contains(parseInt(now[1]),this.smallMonth)&&now[2].slice(0,2)==30){this.WritedOff.push(car[0]);}if(parseInt(now[1])==2&&now[2].slice(0,2)==28){this.WritedOff.push(car[0]);}}}}}}if(now[1]==gettime[1]){if(_count==1){if(parseInt(now[2].slice(0,2))<parseInt(gettime[2])-1){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}else{this.WritedOff.push(car[0]);}}else if(_count==2){if((parseInt(now[0])-1)%4==0){if(parseInt(now[2].slice(0,2))<parseInt(gettime[2])-2){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}else{this.WritedOff.push(car[0]);}}else if(parseInt(now[0])%4==0){if(now[1]==1||now[1]==2&&now[2].slice(0,2)!=29){if(parseInt(now[2].slice(0,2))<parseInt(gettime[2])-1){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}else{this.WritedOff.push(car[0]);}}else{if(parseInt(now[2].slice(0,2))<parseInt(gettime[2])-2){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}else{this.WritedOff.push(car[0]);}}}else if((parseInt(now[0])+2)%4==0){if(gettime[1]==1||gettime[1]==2&&gettime[2]!=29){if(parseInt(now[2].slice(0,2))<parseInt(gettime[2])-2){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}else{this.WritedOff.push(car[0]);}}else{if(parseInt(now[2].slice(0,2))<parseInt(gettime[2])-1){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}else{this.WritedOff.push(car[0]);}}}}}if(parseInt(now[1])+2==gettime[1]){if(_count==1&&gettime[2]==='01'){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}else if(_count==2){if((parseInt(now[0])-1)%4==0){if(gettime[2]==='01'||gettime[2]==='02'){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}}else if(parseInt(now[0])%4==0){if(now[1]==1||now[1]==2&&now[2].slice(0,2)!=29){if(gettime[2]==='01'){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}}else{if(gettime[2]==='01'||gettime[2]==='02'){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}}}else if((parseInt(now[0])+2)%4==0){if(gettime[2]==='01'){this.WriteOff.push(car[0]);this.WriteOffBrand.push(car[2]);}}}}}}if(!this.contains(car[0],this.WriteOff)&&!this.contains(car[0],this.WritedOff)){var distance=parseInt(car[3])%10000;if(distance<=10000&&distance>=9500||distance==0){this.DistanceRelated.push(car[0]);this.DistanceRelatedBrand.push(car[2]);}}if(!this.contains(car[0],this.WriteOff)&&!this.contains(car[0],this.DistanceRelated)&&!this.contains(car[0],this.WritedOff)){if(this.useTime==6){if(parseInt(now[0])-parseInt(gettime[0])<3||parseInt(now[0])-parseInt(gettime[0])==3&&parseInt(now[1])<=parseInt(gettime[1])){if(parseInt(now[1])==parseInt(gettime[1])-1){this.TimeRelated.push(car[0]);this.TimeRelatedBrand.push(car[2]);}if(parseInt(now[1])==parseInt(gettime[1])&&parseInt(now[2].slice(0,2))<parseInt(gettime[2])){this.TimeRelated.push(car[0]);this.TimeRelatedBrand.push(car[2]);}if(gettime[1]==="01"&&now[1]==="12"){this.TimeRelated.push(car[0]);this.TimeRelatedBrand.push(car[2]);}}if(parseInt(now[0])-parseInt(gettime[0])>3||parseInt(now[0])-parseInt(gettime[0])==3&&parseInt(now[1])>parseInt(gettime[1])){var maintainMonth1=parseInt(gettime[1]),maintainMonth2=parseInt(gettime[1])+6>12?parseInt(gettime[1])-6:parseInt(gettime[1])+6;if(parseInt(now[1])==maintainMonth1-1||parseInt(now[1])==maintainMonth2-1){this.TimeRelated.push(car[0]);this.TimeRelatedBrand.push(car[2]);}if(parseInt(now[1])==maintainMonth1&&parseInt(now[2].slice(0,2))<parseInt(gettime[2])||parseInt(now[1])==maintainMonth2&&parseInt(now[2].slice(0,2))<parseInt(gettime[2])){this.TimeRelated.push(car[0]);this.TimeRelatedBrand.push(car[2]);}if(gettime[1]==="01"&&now[1]==="12"||gettime[1]==="07"&&now[1]==="12"){this.TimeRelated.push(car[0]);this.TimeRelatedBrand.push(car[2]);}}}else{var _maintainMonth=parseInt(gettime[1]),_maintainMonth2=parseInt(gettime[1])+3>12?parseInt(gettime[1])-9:parseInt(gettime[1])+3,maintainMonth3=parseInt(gettime[1])+6>12?parseInt(gettime[1])-6:parseInt(gettime[1])+6,maintainMonth4=parseInt(gettime[1])+9>12?parseInt(gettime[1])-3:parseInt(gettime[1])+9;var Months=[_maintainMonth,_maintainMonth2,maintainMonth3,maintainMonth4];var remindMonths=[_maintainMonth-1,_maintainMonth2-1,maintainMonth3-1,maintainMonth4-1];if(this.contains(1,Months)&&now[1]==="12"){this.TimeRelated.push(car[0]);this.TimeRelatedBrand.push(car[2]);}if(this.contains(parseInt(now[1]),remindMonths)){this.TimeRelated.push(car[0]);this.TimeRelatedBrand.push(car[2]);}if(this.contains(parseInt(now[1]),Months)&&parseInt(now[2].slice(0,2))<parseInt(gettime[2])){this.TimeRelated.push(car[0]);this.TimeRelatedBrand.push(car[2]);}}}}}]);return Maintenance;}();var btn=document.getElementById("btn");var btn2=document.getElementById("btn2");var input=document.getElementById('input');var uploadFile=document.getElementById("uploadFile");var show=false;var InputInfo=[];var cars=[];var now="";btn.onclick=function(){if(show){input.style.display='none';btn.innerHTML="显示输入信息";}else{if(document.getElementById("uploadFile").files[0]==null){alert("请上传文件！");return;}input.style.display='block';btn.innerHTML="隐藏输入信息";}show=!show;};uploadFile.onchange=function(){var localFile=document.getElementById("uploadFile").files[0];var reader=new FileReader();var content=void 0;reader.readAsText(localFile,"UTF-8");reader.onload=function(event){content=event.target.result;document.getElementById("fileContent").value=content;InputInfo=content.split('\n');};reader.onerror=function(event){alert('error');};};btn2.onclick=function(){if(InputInfo.length!=0){console.log(InputInfo);now=InputInfo[0].split(" ")[1];cars=InputInfo.slice(1);var maintenance=new Maintenance();for(var i=0;i<cars.length;i++){maintenance.getReminder(now,cars[i]);maintenance.TimeRelatedBrand=maintenance.arrSort(maintenance.TimeRelatedBrand,maintenance.TimeRelated);maintenance.DistanceRelatedBrand=maintenance.arrSort(maintenance.DistanceRelatedBrand,maintenance.DistanceRelated);maintenance.WriteOffBrand=maintenance.arrSort(maintenance.WriteOffBrand,maintenance.WriteOff);}var string1="";var string2="";var string3="";var length=maintenance.TimeRelatedBrand.length;for(var _i3=0;_i3<length;_i3++){string1+=maintenance.TimeRelatedBrand[_i3]+": "+maintenance.TimeRelated[_i3].split(", ").length+" ("+maintenance.TimeRelated[_i3]+")\n";}length=maintenance.DistanceRelatedBrand.length;for(var _i4=0;_i4<length;_i4++){string2+=maintenance.DistanceRelatedBrand[_i4]+": "+maintenance.DistanceRelated[_i4].split(", ").length+" ("+maintenance.DistanceRelated[_i4]+")\n";}length=maintenance.WriteOffBrand.length;for(var _i5=0;_i5<length;_i5++){string3+=maintenance.WriteOffBrand[_i5]+": "+maintenance.WriteOff[_i5].split(", ").length+" ("+maintenance.WriteOff[_i5]+")\n";}var text="Reminder"+"\n"+"=================="+"\n\n"+"* Time-related maintenance coming soon..."+"\n"+string1+"\n"+"* Distance-related maintenance coming soon..."+"\n"+string2+"\n"+"* Write-off coming soon..."+"\n"+string3;document.getElementById("output").value=text;}else{alert("请上传要处理的数据！");}};